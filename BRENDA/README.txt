****************************************************
*** BRENDA - BRing the ENergy, ya damned DAemon! ***
****************************************************
This script is voted to perform an MM-GBSA energy analysis from a sample of 
(protein-protein) complexes.

She needs that you have previously run (with GROMACS) MD simulations and the 
subsequent cluster analyses for every ligand, receptor and complex you need to 
take into account.

Brenda samples, from each trajectory, an amount of snapshots and then she 
minimize them with AMBER sander tool. She performs MM-GBSA with the AMBER 
mm_pbsa.pl script.


*** STEP 0: copy the package into you preferred folder ***
$ cp -rp BRENDA /home/dario/script


*** STEP 1: edit the [.bashrc] file ***
Add the following lines:

# BRENDA
export PATH=/home/dario/script:/home/dario/script/BRENDA/bin:$PATH
export PERL5LIB=/home/dario/script/BRENDA/lib:$PERL5LIB


*** STEP 2: preparing MD with GROMACS ***
BRENDA works with trajectories generated from GROMACS, she search the inputs 
according to a precise nomenclature. Shall we consider that your 
simulation is stored into [/home/dario/LIGAND] you need the following files, 
accompained by the respective subfolders:

[/home/dario/LIGAND/simulazione/MD_50ns.xtc]    # trajectory file
[/home/dario/LIGAND/simulazione/MD_50ns.tpr]    # run input file
[/home/dario/LIGAND/cluster/cluster.log]        # cluster analysis log file

Obviously, such specific paths could be changed by editing the source code of 
the script [/home/dario/script/BRENDA/bin/BRENDA.pl].


*** STEP 3: editing the list file [BRENDA_list.csv] ***
The file [/home/dario/script/BRENDA/BRENDA_list.csv] contains the list of the MD 
simulations. Here below you can find a chunk as example:

ID;RECEPTOR;LIGAND;COMPLEX
CASE_A;/home/dario/RECEPTOR_A;/home/dario/LIGAND_A;/home/dario/COMPLEX_A
CASE_B;/home/dario/RECEPTOR_B;/home/dario/LIGAND_B;/home/dario/COMPLEX_B
[...]

The first line must be the header, the first column contains an id label. The 
remnant columns contain the complete path in which simulations have been stored.


*** STEP 4: run BRENDA ***
$ BRENDA.pl -s 3 -t 6

OPTIONS:
-s  number of snapshots to be sampled (default: 3)
-t  concurrent threads for parallel computing (default: 8)


*** STEP 5: collect the output ***
Other than the output files generated by the AMBER/GROMACS tools, BRENDA also 
outputs a summary csv file in the workdir, called [RAMBO_energy.csv].
BRENDA collects the van der Waals energy (VDW), the electrostatic energy (ELE) 
and the solvent accessible surface area (ASA) for the receptor (r), the ligand 
(l) and the complex (c) counterparts.
For what concern the energy terms 1-4 intramolecular interactions are not taken 
into account.
Each row describe the values for each snapshot sampled, belonging the SYSTEM 
considered.


